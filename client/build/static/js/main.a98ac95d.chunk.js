(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{122:function(e,t,n){},137:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(14),s=n.n(c),i=(n(122),n(123),n(18)),l=n(22),o=n.n(l),u=n(39),d=n(4),b=function(){return Object(a.useCallback)((function(e){window.M&&e&&window.M.toast({html:e})}),[])},j=function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),s=Object(d.a)(c,2),i=s[0],l=s[1];return{loading:n,request:Object(a.useCallback)(function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a,c,s,i,u=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:"GET",a=u.length>2&&void 0!==u[2]?u[2]:null,c=u.length>3&&void 0!==u[3]?u[3]:{},r(!0),e.prev=4,a&&(a=JSON.stringify(a),c["Content-Type"]="application/json"),e.next=8,fetch(t,{method:n,body:a,headers:c});case 8:return s=e.sent,e.next=11,s.json();case 11:if(i=e.sent,s.ok){e.next=14;break}throw new Error(i.message||"Smth went wrong");case 14:return r(!1),e.abrupt("return",i);case 18:throw e.prev=18,e.t0=e.catch(4),r(!1),l(e.t0.message),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t){return e.apply(this,arguments)}}(),[]),error:i,clearError:Object(a.useCallback)((function(){return l(null)}),[])}},h=n(94);function O(){}var p=Object(a.createContext)({token:null,userId:null,login:O,logout:O,isAuthenticated:!1}),f=n(96),m=n.n(f),g=n(7),x=function(){var e=j(),t=e.loading,n=e.request,r=b(),c=Object(a.useState)([]),s=Object(d.a)(c,2),i=s[0],l=s[1],O=Object(a.useState)([]),f=Object(d.a)(O,2),x=f[0],v=f[1],k=Object(a.useContext)(p),w=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n("/block","POST",x);case 3:t=e.sent,r(t.message),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n("/unblock","POST",x);case 3:t=e.sent,r(t.message),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n("/delete","POST",x);case 3:t=e.sent,r(t.message),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){var e,t;(e="GET",t="/table",new Promise((function(n,a){var r=new XMLHttpRequest;r.open(e,t),r.responseType="json",r.onload=function(){r.status>=400?a(r.response):n(r.response)},r.onerror=function(){a(r.response)},r.send()}))).then((function(e){var t=Object.assign([],e.map((function(e){return e.id=e._id,e.registerAt=m()(e.registerAt).format("DD.MM.YYYY HH:mm"),k.userId===e._id&&"BLOCKED"===e.status&&k.logout(k.userId),e})));l(t)}))}),[w,N,S]);return Object(g.jsxs)("div",{style:{height:800,width:"100%"},children:[Object(g.jsx)("button",{className:"btn orange darken-3",style:{marginRight:5},disabled:t,onClick:w,children:"Block"}),Object(g.jsx)("button",{className:"btn green",style:{marginRight:5},disabled:t,onClick:N,children:"UnBlock"}),Object(g.jsx)("button",{className:"btn red",disabled:t,onClick:S,children:"Delete"}),Object(g.jsx)(h.a,{rows:i,columns:[{field:"id",headerName:"ID",width:220},{field:"username",headerName:"Username",width:130},{field:"email",headerName:"Email",width:200},{field:"registerAt",headerName:"RegisterAt",width:170},{field:"status",headerName:"Status",width:130}],pageSize:10,checkboxSelection:!0,onSelectionModelChange:function(e){v(e.selectionModel)},selectionModel:x})]})},v=n(15),k=n(60),w=function(){var e=Object(a.useContext)(p),t=b(),n=j(),r=n.loading,c=n.request,s=n.error,i=n.clearError,l=Object(a.useState)({username:null,email:null,password:null}),h=Object(d.a)(l,2),O=h[0],f=h[1];Object(a.useEffect)((function(){t(s),i()}),[s,t,i]);var m=function(e){f(Object(k.a)(Object(k.a)({},O),{},Object(v.a)({},e.target.name,e.target.value)))},x=function(){var e=Object(u.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c("/register","POST",Object(k.a)({},O));case 3:n=e.sent,t(n.message),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var t=Object(u.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c("/login","POST",Object(k.a)({},O));case 3:n=t.sent,e.login(n.token,n.userId),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return Object(g.jsx)("div",{className:"row",children:Object(g.jsx)("div",{className:"col s6 offset-s3",children:Object(g.jsxs)("div",{className:"card blue lighten-2",children:[Object(g.jsxs)("div",{className:"card-content white-text",children:[Object(g.jsx)("span",{className:"card-title",children:"Welcome! LogIn or create new account"}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{className:"input-field",children:[Object(g.jsx)("input",{placeholder:"Enter username",id:"username",type:"text",name:"username",className:"black-input",onChange:m}),Object(g.jsx)("label",{htmlFor:"username",children:"Username"})]}),Object(g.jsxs)("div",{className:"input-field",children:[Object(g.jsx)("input",{placeholder:"Enter email",id:"email",type:"text",name:"email",className:"black-input",onChange:m}),Object(g.jsx)("label",{htmlFor:"email",children:"Email"})]}),Object(g.jsxs)("div",{className:"input-field",children:[Object(g.jsx)("input",{placeholder:"Enter password",id:"password",type:"password",name:"password",className:"black-input",onChange:m}),Object(g.jsx)("label",{htmlFor:"password",children:"Password"})]})]})]}),Object(g.jsxs)("div",{className:"card-action",children:[Object(g.jsx)("button",{className:"btn orange darken-3",style:{marginRight:10},disabled:r,onClick:w,children:"LogIn"}),Object(g.jsx)("button",{className:"btn light-green accent-3",onClick:x,disabled:r,children:"Register"})]})]})})})},N=n(56),S="userData",C=function(){var e=Object(i.g)(),t=Object(a.useContext)(p);return Object(g.jsx)("nav",{children:Object(g.jsxs)("div",{className:"nav-wrapper blue lighten-2",children:[Object(g.jsx)("div",{className:"brand-logo",children:"ILearning"}),Object(g.jsx)("ul",{id:"nav-mobile",className:"right hide-on-med-and-down oran",children:Object(g.jsx)("li",{children:Object(g.jsx)("a",{href:"/",onClick:function(n){n.preventDefault(),t.logout(),e.push("/")},children:"Logout"})})})]})})};var y=function(){var e=function(){var e=Object(a.useState)(null),t=Object(d.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),s=Object(d.a)(c,2),i=s[0],l=s[1],o=Object(a.useCallback)((function(e,t){r(e),l(t),localStorage.setItem(S,JSON.stringify({userId:t,token:e}))}),[]),u=Object(a.useCallback)((function(){r(null),l(null),localStorage.removeItem(S)}),[]);return Object(a.useEffect)((function(){var e=JSON.parse(localStorage.getItem(S));e&&e.token&&o(e.token,e.userId)}),[o]),{login:o,logout:u,token:n,userId:i}}(),t=e.token,n=e.userId,r=e.login,c=e.logout,s=!!t,l=function(e){return e?Object(g.jsxs)(i.d,{children:[Object(g.jsx)(i.b,{path:"/table",exact:!0,children:Object(g.jsx)(x,{})}),Object(g.jsx)(i.a,{to:"/table"})]}):Object(g.jsxs)(i.d,{children:[Object(g.jsx)(i.b,{path:"/",exact:!0,children:Object(g.jsx)(w,{})}),Object(g.jsx)(i.a,{to:"/"})]})}(s);return Object(g.jsx)(p.Provider,{value:{token:t,userId:n,login:r,logout:c,isAuthenticated:s},children:Object(g.jsxs)(N.a,{children:[s&&Object(g.jsx)(C,{}),Object(g.jsx)("div",{className:"container",children:l})]})})},I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,187)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(y,{})}),document.getElementById("root")),I()}},[[137,1,2]]]);
//# sourceMappingURL=main.a98ac95d.chunk.js.map